---
layout: post
title: MapLibre & the 2026 European Solar Eclipse
image: /assets/images/eclipse_static_image.png
tags:
  - portfolio
  - maplibre
author: By Chiara Phillips
published: true
---

<style>
/* Dark theme for eclipse post - CSS Variables */
:root {
  --eclipse-bg-color: #111111;
  --eclipse-text-color: #ffffff;
  --eclipse-text-muted: #d1d5db;
  --eclipse-link-color: #60a5fa;
  --eclipse-link-hover: #93c5fd;
  --eclipse-info-bg: #1f2937;
  --eclipse-border: #374151;
}

html, body {
  background-color: var(--eclipse-bg-color) !important;
  background: var(--eclipse-bg-color) !important;
  color: var(--eclipse-text-color) !important;
}

/* Target the main content area */
.flex.justify-center {
  background-color: var(--eclipse-bg-color) !important;
}

/* Target the article container */
article {
  background-color: var(--eclipse-bg-color) !important;
  color: var(--eclipse-text-color) !important;
}

.prose {
  color: var(--eclipse-text-color) !important;
  background-color: var(--eclipse-bg-color) !important;
}

.prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
  color: var(--eclipse-text-color) !important;
}

.prose p {
  color: var(--eclipse-text-color) !important;
}

.prose a {
  color: var(--eclipse-link-color) !important;
}

.prose a:hover {
  color: var(--eclipse-link-hover) !important;
}

/* Override the info box styling */
.info-box {
  background: var(--eclipse-info-bg) !important;
  border: 1px solid var(--eclipse-border) !important;
  color: var(--eclipse-text-color) !important;
}

.info-box h4 {
  color: var(--eclipse-text-color) !important;
}

.info-box span {
  color: var(--eclipse-text-muted) !important;
}

/* Map container styling */
#eclipse-map {
  background: var(--eclipse-bg-color) !important;
  border: none !important;
}

/* Override any other white backgrounds */
.bg-white {
  background-color: var(--eclipse-bg-color) !important;
}

/* Ensure text is visible on dark background */
.text-slate-700 {
  color: var(--eclipse-text-muted) !important;
}

.text-black {
  color: var(--eclipse-text-color) !important;
}

/* Force the main container to be dark */
.mx-auto {
  background-color: var(--eclipse-bg-color) !important;
}

/* Override any Tailwind classes that might be adding blue */
.fadeIn {
  background-color: var(--eclipse-bg-color) !important;
}

/* Target the post layout specifically */
.flex.flex-col.md\\:flex-row {
  background-color: var(--eclipse-bg-color) !important;
}

/* MapLibre popup styling */
.maplibregl-popup-content {
  background-color: #717b83 !important;
  color: #ffffff !important;
  border-radius: 8px !important;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3) !important;
}

.maplibregl-popup-tip {
  border-top-color: #717b83 !important;
}

.maplibregl-popup-close-button {
  color: #ffffff !important;
  font-size: 18px !important;
}

.maplibregl-popup-close-button:hover {
  color: #dbeafe !important;
}

/* Heading 1 styling */
.prose h1 {
  text-align: center !important;
  font-size: 2rem !important;
  padding-top: 2rem !important;
  margin-bottom: 1.5rem !important;
}

/* Heading 2 styling */
.prose h2 {
  text-align: center !important;
  font-size: 1.5rem !important;
  padding-top: 1.5rem !important;
  margin-bottom: 1.5rem !important;
}
</style>

On August 12, 2026, the Moon will cast its shadow across a narrow path stretching from 
Siberia to eastern Greenland, the west coast of Iceland, and northern
 Spain. Those who venture into its path will witness one of nature’s most 
 extraordinary spectacles: a total solar eclipse.

During totality, the Sun’s normally invisible outer atmosphere becomes briefly visible,
producing a shimmering halo effect around the darkened Sun. 

A solar eclipse can only take place during a new moon, when the Moon passes directly
 between Earth and the Sun. It should be noted however, that 
 not every new moon results in a total eclipse. Only when the Moon's orbit is closer to 
 Earth, at a point called "perigee", does it look large enough to completely
  cover the Sun.

![Total Solar Eclipse](/assets/images/total-solar-eclipse-com.png)

In most places, a total solar eclipse is a once-in-a-lifetime opportunity. Spaniards,
however, have particular celestial luck, as they will also experience 
a total solar eclipse just one year later, on August 2, 2027.

# Where Can I See the Eclipse?
In this interactive map, you can see several cities that will be in the path of 
totality before sunset.


<div id="eclipse-map" style="height: 600px; width: 100%; background: var(--eclipse-bg-color); border-radius: 8px; border: none; position: relative;"></div>


<script src="https://unpkg.com/maplibre-gl@5.6.2/dist/maplibre-gl.js"></script>
<link href="https://unpkg.com/maplibre-gl@5.6.2/dist/maplibre-gl.css" rel="stylesheet">

<!-- Load the maplibre-gl-geocoder plugin -->
<script src="https://unpkg.com/@maplibre/maplibre-gl-geocoder@1.5.0/dist/maplibre-gl-geocoder.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/@maplibre/maplibre-gl-geocoder@1.5.0/dist/maplibre-gl-geocoder.css" />

<script>
document.addEventListener('DOMContentLoaded', function() {
    const map = new maplibregl.Map({
        container: 'eclipse-map',
        style: '/assets/maps/voyager-edited.json',
        zoom: 2.5,
        center: [0, 55],
    });

    map.on('style.load', () => {
        map.setProjection({
            type: 'globe'
        });
    });

    const eclipseLocations = [
  {
    name: "Ísafjörður, Iceland",
    lng: -23.13498,
    lat: 66.07475,
    airport: "Ísafjörður Airport (IFJ)",
    travel: { byCarHours: 0.1, byTransitHours: 0.1 },
    mapsUrl: "https://www.google.com/maps/search/Ísafjörður, Iceland",
    eclipse: {
      start: "2026-08-12T17:44:09+00:00",
      end:   "2026-08-12T17:45:39+00:00",
      durationSec: 90,
      afterSunset: false
    }
  },
  {
    name: "Borgarnes, Iceland",
    lng: -21.901,
    lat: 64.5609,
    airport: "Reykjavík Domestic (RKV)",
    travel: { byCarHours: 1.0, byTransitHours: 1.3 },
    mapsUrl: "https://www.google.com/maps/search/Borgarnes, Iceland",
    eclipse: {
      start: "2026-08-12T17:47:44+00:00",
      end:   "2026-08-12T17:48:23+00:00",
      durationSec: 39,
      afterSunset: false
    }
  },
  {
    name: "Reykjavik, Iceland",
    lng: -21.8954,
    lat: 64.1355,
    airport: "Reykjavík Domestic (RKV)",
    travel: { byCarHours: 0.2, byTransitHours: 0.2 },
    mapsUrl: "https://www.google.com/maps/search/Reykjavik, Iceland",
    eclipse: {
      start: "2026-08-12T17:48:19+00:00",
      end:   "2026-08-12T17:49:18+00:00",
      durationSec: 59,
      afterSunset: false
    }
  },
  {
    name: "Keflavík, Iceland",
    lng: -22.56242,
    lat: 64.00492,
    airport: "Keflavík International (KEF)",
    travel: { byCarHours: 0.2, byTransitHours: 0.3 },
    mapsUrl: "https://www.google.com/maps/search/Keflavík, Iceland",
    eclipse: {
      start: "2026-08-12T17:48:06+00:00",
      end:   "2026-08-12T17:49:45+00:00",
      durationSec: 99,
      afterSunset: false
    }
  },
  {
    name: "Santander, Cantabria, Spain",
    lng: -3.805,
    lat: 43.462776,
    airport: "Santander (SDR)",
    travel: { byCarHours: 0.2, byTransitHours: 0.3 },
    mapsUrl: "https://www.google.com/maps/search/Santander, Spain",
    eclipse: {
      start: "2026-08-12T20:26:58+02:00",
      end:   "2026-08-12T20:28:01+02:00",
      durationSec: 63,
      afterSunset: false
    }
  },
  {
    name: "Bilbao, Vizcaya, Spain",
    lng: -2.9253,
    lat: 43.2627,
    airport: "Bilbao (BIO)",
    travel: { byCarHours: 0.2, byTransitHours: 0.3 },
    mapsUrl: "https://www.google.com/maps/search/Bilbao, Spain",
    eclipse: {
      start: "2026-08-12T20:27:24+02:00",
      end:   "2026-08-12T20:27:53+02:00",
      durationSec: 29,
      afterSunset: true
    }
  },
  {
    name: "Gijón, Asturias, Spain",
    lng: -5.6615,
    lat: 43.5357,
    airport: "Asturias Airport (OVD)",
    travel: { byCarHours: 0.6, byTransitHours: 0.8 },
    mapsUrl: "https://www.google.com/maps/search/Gijón, Spain",
    eclipse: {
      start: "2026-08-12T20:26:49+02:00",
      end:   "2026-08-12T20:28:34+02:00",
      durationSec: 105,
      afterSunset: false
    }
  },
  {
    name: "Oviedo, Asturias, Spain",
    lng: -5.8448,
    lat: 43.3603,
    airport: "Asturias Airport (OVD)",
    travel: { byCarHours: 0.6, byTransitHours: 0.7 },
    mapsUrl: "https://www.google.com/maps/search/Oviedo, Spain",
    eclipse: {
      start: "2026-08-12T20:27:06+02:00",
      end:   "2026-08-12T20:28:54+02:00",
      durationSec: 108,
      afterSunset: false
    }
  },
  {
    name: "Vitoria-Gasteiz, Álava, Spain",
    lng: -2.67268,
    lat: 42.84998,
    airport: "Vitoria (VIT)",
    travel: { byCarHours: 0.2, byTransitHours: 0.3 },
    mapsUrl: "https://www.google.com/maps/search/Vitoria-Gasteiz, Spain",
    eclipse: {
      start: "2026-08-12T20:27:44+02:00",
      end:   "2026-08-12T20:28:46+02:00",
      durationSec: 62,
      afterSunset: true
    }
  },
  {
    name: "A Coruña, A Coruña, Spain",
    lng: -8.396,
    lat: 43.3714,
    airport: "A Coruña (LCG)",
    travel: { byCarHours: 0.3, byTransitHours: 0.3 },
    mapsUrl: "https://www.google.com/maps/search/A Coruña, Spain",
    eclipse: {
      start: "2026-08-12T20:27:43+02:00",
      end:   "2026-08-12T20:28:59+02:00",
      durationSec: 76,
      afterSunset: false
    }
  },
  {
    name: "Lugo, Lugo, Spain",
    lng: -7.55,
    lat: 43.016666,
    airport: "Santiago de Compostela (SCQ)",
    travel: { byCarHours: 1.3, byTransitHours: 1.8 },
    mapsUrl: "https://www.google.com/maps/search/Lugo, Spain",
    eclipse: {
      start: "2026-08-12T20:28:08+02:00",
      end:   "2026-08-12T20:29:32+02:00",
      durationSec: 84,
      afterSunset: false
    }
  },
  {
    name: "Logroño, La Rioja, Spain",
    lng: -2.45,
    lat: 42.46667,
    airport: "Logroño–Agoncillo (RJL)",
    travel: { byCarHours: 0.3, byTransitHours: 0.4 },
    mapsUrl: "https://www.google.com/maps/search/Logroño, Spain",
    eclipse: {
      start: "2026-08-12T20:28:10+02:00",
      end:   "2026-08-12T20:29:31+02:00",
      durationSec: 81,
      afterSunset: true
    }
  },
  {
    name: "Burgos, Burgos, Spain",
    lng: -3.6753,
    lat: 42.3502,
    airport: "Burgos (RGS)",
    travel: { byCarHours: 0.3, byTransitHours: 0.4 },
    mapsUrl: "https://www.google.com/maps/search/Burgos, Spain",
    eclipse: {
      start: "2026-08-12T20:28:25+02:00",
      end:   "2026-08-12T20:30:08+02:00",
      durationSec: 103,
      afterSunset: true
    }
  },
  {
    name: "Ponferrada, León, Spain",
    lng: -6.59619,
    lat: 42.54664,
    airport: "León (LEN)",
    travel: { byCarHours: 1.4, byTransitHours: 1.8 },
    mapsUrl: "https://www.google.com/maps/search/Ponferrada, Spain",
    eclipse: {
      start: "2026-08-12T20:28:45+02:00",
      end:   "2026-08-12T20:30:12+02:00",
      durationSec: 87,
      afterSunset: false
    }
  },
  {
    name: "Zaragoza, Zaragoza, Spain",
    lng: -0.87734,
    lat: 41.65606,
    airport: "Zaragoza (ZAZ)",
    travel: { byCarHours: 0.3, byTransitHours: 0.4 },
    mapsUrl: "https://www.google.com/maps/search/Zaragoza, Spain",
    eclipse: {
      start: "2026-08-12T20:29:04+02:00",
      end:   "2026-08-12T20:30:28+02:00",
      durationSec: 84,
      afterSunset: true
    }
  },
  {
    name: "Palencia, Palencia, Spain",
    lng: -4.52406,
    lat: 42.00955,
    airport: "Valladolid (VLL)",
    travel: { byCarHours: 0.7, byTransitHours: 0.9 },
    mapsUrl: "https://www.google.com/maps/search/Palencia, Spain",
    eclipse: {
      start: "2026-08-12T20:29:09+02:00",
      end:   "2026-08-12T20:30:51+02:00",
      durationSec: 102,
      afterSunset: false
    }
  },
  // Salou (Tarragona) — not in the provided table; left without eclipse fields.
  {
    name: "Valladolid, Valladolid, Spain",
    lng: -4.72372,
    lat: 41.65518,
    airport: "Valladolid (VLL)",
    travel: { byCarHours: 0.3, byTransitHours: 0.4 },
    mapsUrl: "https://www.google.com/maps/search/Valladolid, Spain",
    eclipse: {
      start: "2026-08-12T20:29:53+02:00",
      end:   "2026-08-12T20:31:21+02:00",
      durationSec: 88,
      afterSunset: true
    }
  },
  {
    name: "Mahón, Menorca, Spain",
    lng: 4.26111,
    lat: 39.8875,
    airport: "Menorca (MAH)",
    travel: { byCarHours: 0.2, byTransitHours: 0.3 },
    mapsUrl: "https://www.google.com/maps/search/Mahón, Spain",
    eclipse: {
      start: "2026-08-12T20:30:17+02:00",
      end:   "2026-08-12T20:31:27+02:00",
      durationSec: 70,
      afterSunset: true
    }
  },
  // Port de Pollença — not in the provided table; left without eclipse fields.
  {
    name: "Alcúdia, Baleares, Spain",
    lng: 3.1214,
    lat: 39.8532,
    airport: "Palma de Mallorca (PMI)",
    travel: { byCarHours: 0.9, byTransitHours: 1.2 },
    mapsUrl: "https://www.google.com/maps/search/Alcúdia, Spain",
    eclipse: {
      start: "2026-08-12T20:30:34+02:00",
      end:   "2026-08-12T20:32:03+02:00",
      durationSec: 89,
      afterSunset: true
    }
  },
  {
    name: "Segovia, Segovia, Spain",
    lng: -4.108807,
    lat: 40.942902,
    airport: "Madrid–Barajas (MAD)",
    travel: { byCarHours: 1.2, byTransitHours: 1.8 },
    mapsUrl: "https://www.google.com/maps/search/Segovia, Spain",
    eclipse: {
      start: "2026-08-12T20:31:09+02:00",
      end:   "2026-08-12T20:32:08+02:00",
      durationSec: 59,
      afterSunset: true
    }
  },
  {
    name: "Teruel, Teruel, Spain",
    lng: -1.10646,
    lat: 40.3456,
    airport: "València (VLC)",
    travel: { byCarHours: 1.8, byTransitHours: 2.5 },
    mapsUrl: "https://www.google.com/maps/search/Teruel, Spain",
    eclipse: {
      start: "2026-08-12T20:31:05+02:00",
      end:   "2026-08-12T20:32:39+02:00",
      durationSec: 94,
      afterSunset: true
    }
  },
  {
    name: "Palma, Majorca, Spain",
    lng: 2.650544,
    lat: 39.571625,
    airport: "Palma de Mallorca (PMI)",
    travel: { byCarHours: 0.3, byTransitHours: 0.4 },
    mapsUrl: "https://www.google.com/maps/search/Palma, Spain",
    eclipse: {
      start: "2026-08-12T20:31:05+02:00",
      end:   "2026-08-12T20:32:41+02:00",
      durationSec: 96,
      afterSunset: true
    }
  },
  {
    name: "Guadalajara, Guadalajara, Spain",
    lng: -3.16185,
    lat: 40.62862,
    airport: "Madrid–Barajas (MAD)",
    travel: { byCarHours: 0.7, byTransitHours: 1.2 },
    mapsUrl: "https://www.google.com/maps/search/Guadalajara, Spain",
    eclipse: {
      start: "2026-08-12T20:31:21+02:00",
      end:   "2026-08-12T20:32:29+02:00",
      durationSec: 68,
      afterSunset: true
    }
  },
  {
    name: "Cuenca, Cuenca, Spain",
    lng: -2.137416,
    lat: 40.070393,
    airport: "Madrid–Barajas (MAD)",
    travel: { byCarHours: 1.8, byTransitHours: 2.2 },
    mapsUrl: "https://www.google.com/maps/search/Cuenca, Spain",
    eclipse: {
      start: "2026-08-12T20:32:06+02:00",
      end:   "2026-08-12T20:33:01+02:00",
      durationSec: 55,
      afterSunset: true
    }
  },
  {
    name: "Valencia, Valencia, Spain",
    lng: -0.3774,
    lat: 39.4698,
    airport: "València (VLC)",
    travel: { byCarHours: 0.3, byTransitHours: 0.4 },
    mapsUrl: "https://www.google.com/maps/search/Valencia, Spain",
    eclipse: {
      start: "2026-08-12T20:32:30+02:00",
      end:   "2026-08-12T20:33:30+02:00",
      durationSec: 60,
      afterSunset: true
    }
  },
  {
    name: "Sant Antoni de Portmany, Ibiza, Spain",
    lng: 1.30362,
    lat: 38.98068,
    airport: "Ibiza (IBZ)",
    travel: { byCarHours: 0.5, byTransitHours: 0.8 },
    mapsUrl: "https://www.google.com/maps/search/Sant Antoni de Portmany, Spain",
    eclipse: {
      start: "2026-08-12T20:32:40+02:00",
      end:   "2026-08-12T20:33:47+02:00",
      durationSec: 67,
      afterSunset: true
    }
  },
  {
    name: "Ibiza, Ibiza, Spain",
    lng: 1.421416,
    lat: 38.906986,
    airport: "Ibiza (IBZ)",
    travel: { byCarHours: 0.2, byTransitHours: 0.4 },
    mapsUrl: "https://www.google.com/maps/search/Ibiza, Spain",
    eclipse: {
      start: "2026-08-12T20:32:46+02:00",
      end:   "2026-08-12T20:33:50+02:00",
      durationSec: 64,
      afterSunset: true
    }
  }
];


    // Esri color ramps - Purple 13 (inverted for accessibility)
    const colors = ["#e566ffff", "#8f14f7ff", "#43048dff"]; // Pink (easy) to Dark Purple (hard)
    
    // Function to format time display
    function formatTime(hours) {
        const totalMinutes = Math.round(hours * 60);
        if (totalMinutes < 60) {
            return `${totalMinutes} minutes`;
        } else {
            const hoursPart = Math.floor(totalMinutes / 60);
            const minutesPart = totalMinutes % 60;
            if (minutesPart === 0) {
                return `${hoursPart} hour${hoursPart > 1 ? 's' : ''}`;
            } else {
                return `${hoursPart} hour${hoursPart > 1 ? 's' : ''} ${minutesPart} minutes`;
            }
        }
    }

    // Function to format eclipse time (extract hour:minute from ISO string)
    function formatEclipseTime(isoString) {
        const date = new Date(isoString);
        const hours = date.getHours().toString().padStart(2, '0');
        const minutes = date.getMinutes().toString().padStart(2, '0');
        return `${hours}:${minutes}`;
    }

    // Filter out locations that are after sunset
    const visibleLocations = eclipseLocations.filter(location => !location.eclipse.afterSunset);
    
    // Create circle markers for each visible location
    visibleLocations.forEach(location => {
        // Categorical color based on transit hours
        let markerColor;
        if (location.travel.byTransitHours < 1) {
            markerColor = colors[0]; // Pink - Less than 1 hour (easiest)
        } else if (location.travel.byTransitHours < 2) {
            markerColor = colors[1]; // Medium Purple - 1-2 hours (medium)
        } else {
            markerColor = colors[2]; // Dark Purple - 2+ hours (hardest)
        }
        
        // Calculate marker size based on eclipse duration (30-120 seconds range)
        const minDuration = 30;
        const maxDuration = 120;
        const duration = location.eclipse.durationSec;
        const normalizedDuration = Math.max(0, Math.min(1, (duration - minDuration) / (maxDuration - minDuration)));
        const markerSize = 8 + (normalizedDuration * 16); // Size between 8px and 24px
        
        const el = document.createElement('div');
        el.className = 'marker';
        el.style.width = `${markerSize}px`;
        el.style.height = `${markerSize}px`;
        el.style.borderRadius = '50%';
        el.style.backgroundColor = 'black';
        el.style.border = '2px solid white';
        el.style.cursor = 'pointer';
        el.style.boxShadow = '0 0 8px rgba(255,255,255,0.8), 0 0 16px rgba(255,255,255,0.4), 0 2px 4px rgba(0,0,0,0.3)';
        
        let popup = null;
        
        let hoverTimeout = null;
        
        el.addEventListener('mouseenter', () => {
            // Clear any existing timeout
            if (hoverTimeout) {
                clearTimeout(hoverTimeout);
                hoverTimeout = null;
            }
            
            popup = new maplibregl.Popup()
                .setLngLat([location.lng, location.lat])
                .setHTML(`
                    <div style="padding: 8px;">
                        <strong>${location.name}</strong><br/>
                        <strong>Eclipse Start:</strong> ${formatEclipseTime(location.eclipse.start)}<br/>
                        <strong>Eclipse End:</strong> ${formatEclipseTime(location.eclipse.end)}<br/>
                        <strong>Eclipse Duration:</strong> ${location.eclipse.durationSec} seconds<br/>
                        <strong>Closest Airport:</strong> ${location.airport}<br/>
                        <strong>Public transit time from ${location.airport}:</strong> ${formatTime(location.travel.byTransitHours)}<br/>
                        <a href="${location.mapsUrl}" target="_blank" style="color: #0066cc;">View on Google Maps</a>
                    </div>
                `)
                .addTo(map);
                
            // Add hover listeners to the popup content
            setTimeout(() => {
                const popupElement = document.querySelector('.maplibregl-popup-content');
                if (popupElement) {
                    popupElement.addEventListener('mouseenter', () => {
                        if (hoverTimeout) {
                            clearTimeout(hoverTimeout);
                            hoverTimeout = null;
                        }
                    });
                    
                    popupElement.addEventListener('mouseleave', () => {
                        hoverTimeout = setTimeout(() => {
                            if (popup) {
                                popup.remove();
                                popup = null;
                            }
                        }, 100);
                    });
                }
            }, 50);
        });
        
        el.addEventListener('mouseleave', () => {
            // Add a small delay before removing popup
            hoverTimeout = setTimeout(() => {
            if (popup) {
                popup.remove();
                popup = null;
            }
            }, 100);
        });
        
        new maplibregl.Marker({element: el})
            .setLngLat([location.lng, location.lat])
            .addTo(map);

        // Add text label for city name and start time
        const labelEl = document.createElement('div');
        labelEl.className = 'city-time-label';
        labelEl.innerHTML = `
            <div style="font-weight: bold; font-size: 13px; line-height: 1.2;">${location.name}</div>
            <div style="font-size: 11px; line-height: 1.2; color: #cd9b49;">${formatEclipseTime(location.eclipse.start)}</div>
        `;
        labelEl.style.color = 'white';
        labelEl.style.textShadow = '1px 1px 2px rgba(0,0,0,0.8)';
        labelEl.style.pointerEvents = 'none';
        labelEl.style.textAlign = 'center';
        labelEl.style.whiteSpace = 'nowrap';
        labelEl.style.display = 'none'; // Initially hidden

        // Add label marker to map (offset slightly from the circle)
        const labelMarker = new maplibregl.Marker({element: labelEl})
            .setLngLat([location.lng, location.lat])
            .setOffset([0, 35]) // Offset below the circle
            .addTo(map);

        // Store reference for zoom-based visibility
        location.labelMarker = labelMarker;
        location.labelElement = labelEl;
    });
    
    // Function to update label visibility based on zoom level
    function updateLabelVisibility() {
        const zoom = map.getZoom();
        const visibleLocations = eclipseLocations.filter(location => !location.eclipse.afterSunset);
        
        visibleLocations.forEach(location => {
            if (zoom >= 4) {
                location.labelElement.style.display = 'block';
            } else {
                location.labelElement.style.display = 'none';
            }
        });
    }

    // Update label visibility on zoom
    map.on('zoom', updateLabelVisibility);
    map.on('zoomend', updateLabelVisibility);

    map.on('load', async () => {
        // Load the eclipse data from the JSON file
        const response = await fetch('/assets/maps/eclipse_data.json');
        const eclipseData = await response.json();
        
        map.addSource('eclipse_data', {
            'type': 'geojson',
            'data': eclipseData
        });
        map.addLayer({
            'id': 'eclipse_data',
            'type': 'fill',
            'source': 'eclipse_data',
            'layout': {},
            'paint': {
                'fill-color': 'black',
                'fill-opacity': 0.6
            }
        });

        // Add geocoder control
        const geocoderApi = {
            forwardGeocode: async (config) => {
                const features = [];
                try {
                    const request = `https://nominatim.openstreetmap.org/search?q=${config.query}&format=geojson&polygon_geojson=1&addressdetails=1`;
                    const response = await fetch(request);
                    const geojson = await response.json();
                    for (const feature of geojson.features) {
                        const center = [
                            feature.bbox[0] + (feature.bbox[2] - feature.bbox[0]) / 2,
                            feature.bbox[1] + (feature.bbox[3] - feature.bbox[1]) / 2
                        ];
                        const point = {
                            type: 'Feature',
                            geometry: {
                                type: 'Point',
                                coordinates: center
                            },
                            place_name: feature.properties.display_name,
                            properties: feature.properties,
                            text: feature.properties.display_name,
                            place_type: ['place'],
                            center
                        };
                        features.push(point);
                    }
                } catch (e) {
                    console.error(`Failed to forwardGeocode with error: ${e}`);
                }
                return { features };
            }
        };

        map.addControl(
            new MaplibreGeocoder(geocoderApi, {
                maplibregl: maplibregl,
                placeholder: 'Search for a location...',
                marker: true,
                showResultsWhileTyping: true
            })
        );

        // Add custom legend control
        class LegendControl {
            onAdd(map) {
                this._map = map;
                this._container = document.createElement('div');
                this._container.className = 'maplibregl-ctrl';
                this._container.style.padding = '15px';
                this._container.style.borderRadius = '8px';
                this._container.style.fontFamily = 'Arial, sans-serif';
                this._container.style.fontSize = '12px';
                this._container.style.maxWidth = '200px';
                this._container.innerHTML = `
                    <div style="margin-bottom: 8px;">
                        <div style="display: flex; align-items: center; margin-bottom: 5px;">
                            <div style="width: 16px; height: 8px; background: rgba(0, 0, 0, 0.6); margin-right: 8px; border: 0px;"></div>
                            <span style="color: white;">Path of total eclipse</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 5px;">
                            <div style="width: 12px; height: 12px; background: black; border-radius: 50%; margin-right: 8px; border: 2px solid white; box-shadow: 0 0 8px rgba(255,255,255,0.8);"></div>
                            <span style="color: white;">Eclipse city</span>
                        </div>
                        <div>
                        <i>Larger = longer eclipse</i>
                        </div>
                    </div>
                `;
                return this._container;
            }

            onRemove() {
                this._container.parentNode.removeChild(this._container);
                this._map = undefined;
            }
        }

        map.addControl(new LegendControl(), 'bottom-left');
        
        // Update label visibility for the initial zoom level
        updateLabelVisibility();
    });
});

</script>
# Eclipse Tips
• **Check the weather.** Clear skies make all the difference, so look at 
forecasts before your trip and avoid regions with heavy cloud cover if possible.

• **Wear green.** Thanks to the Purkinje effect, the human eye becomes more 
sensitive to blue-green colors in low light. As daylight fades during 
totality, wearing green can make your clothing stand out more vividly against 
the dimmed background.

• **Protect your eyes.** Always bring certified eclipse glasses or viewers. Looking
 at the sun without protection during the partial phases can cause permanent eye damage.

## About This Map
I was inspired to create this interactive map because a dear friend of mine and I are going
 to meet up and see the eclipse together this coming year!

• To create this interactive map, I first needed to find geospatial data of the eclipse's umbral
path. After digging through several NASA websites, I was pointed to eclipse path data
 courtesy of [Xavier Jubier](http://xjubier.free.fr/en/site_pages/SolarEclipsesGoogleEarth.html){: style="color: #0066cc; text-decoration: underline;"}.

• I then continued my research and found some cities that are within the path 
of totality [online](https://www.timeanddate.com/eclipse/solar/2026-august-12){: style="color: #0066cc; text-decoration: underline;"}.

• I used ChatGPT to retrieve latitude and longitude coordinates for these cities and pasted the results into a Google Sheet. 

• From there, I used a Streamlit app I developed called [Click2Vector](https://click2vector.streamlit.app/){: style="color: #0066cc; text-decoration: underline;"} to translate the x/y locations into a format ready for MapLibre. 

• After building interactive map using MapLibre and editing the basemap style in Maputnik, I used the [Jekyll-Maplibre plugin](https://github.com/rriemann/jekyll-maplibre){: style="color: #0066cc; text-decoration: underline;"} for display in this post.
